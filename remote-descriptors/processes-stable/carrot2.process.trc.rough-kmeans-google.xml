<?xml version="1.0" encoding="UTF-8"?>

<process
    xmlns="http://www.dawidweiss.com/projects/carrot/processDescriptor"
    id="carrot2.process.trc.rough-kmeans-google"
    description="Google, Rough-KMeans, Dynamic Tree"
>
    <processing-script language="beanshell"><![CDATA[

    controller.setUseCachedInput(true);
    controller.setDoCacheInput(true);

    InputStream is;

    is = controller.invokeInputComponent( "carrot2.input.snippet-reader.google", query );

    Map options = new HashMap();

    options.put("clusters.initial", "40");
    options.put("similarity.threshold",  "0.3");
    options.put("cooccurrence.threshold",  "5");
    options.put("phrase.used",  "false");

    is = controller.invokeFilterComponent( "carrot2.filter.trc.rough-kmeans-cluster", is, options );

    Map dtreeOptions = new HashMap();
    dtreeOptions.put("dtree.css", "compact");
    dtreeOptions.put("param.output.terminal.nodes", "true" );
    dtreeOptions.put("param.max.open.level", "0");
    dtreeOptions.put("param.max.subgroup.snippets.included", "3" );
    dtreeOptions.put("param.no.terminal.groups.expansion", "true" );
    dtreeOptions.put("param.snippets.sorting.type", "ORDER_DOCUMENTS_ORDER");

    is = controller.invokeOutputComponent( "carrot2.output.xslt-renderer.dynamic-tree", is, dtreeOptions );
    controller.sendResponse( is );

    ]]>
    </processing-script>
</process>

