Stable release procedure
------------------------

Note: Stable releases are always made from trunk.


1. Make sure trunk is stable and all tests pass (http://builds.carrot2.org/browse/C2HEAD-COMMIT)
   See below for rough QA guidelines.


2. Update the stable branch

svn remove https://dev.carrot-search.com/svn/carrot2-private/branches/stable/code -m "Removing old stable branch"
svn copy https://dev.carrot-search.com/svn/carrot2-private/trunk/code https://dev.carrot-search.com/svn/carrot2-private/branches/stable/code -m "New stable branch"


3. Update version number

Edit https://carrot2.svn.sourceforge.net/svnroot/carrot2/branches/stable/carrot2/carrot2.version

svn commit https://carrot2.svn.sourceforge.net/svnroot/carrot2/branches/stable/carrot2/carrot2.version -m "Version number updated"


4. Trigger the stable build on the build server:

http://builds.carrot2.org/browse/C2STABLE-COMMIT

The build must pass without errors.


5. Verify if the automatically deployed demo webapp works:

http://demo.carrot2.org/


6. Create a tag

svn copy https://carrot2.svn.sourceforge.net/svnroot/carrot2/branches/stable/carrot2 https://carrot2.svn.sourceforge.net/svnroot/carrot2/tags/VERSION_2_1_3 -m "Tag created"


7. Build the website

Update download links in (e.g.: :%s/2.1.2/2.1.3/g)

https://carrot2.svn.sourceforge.net/svnroot/carrot2/website/src/download.xml

Commit and let the build server upload the new website.


8. Update JIRA

   a. Create a new version in JIRA 
   b. Move all unresolved JIRA issues to the next release
   c. Close all resolved issues in the released version
   d. Mark the released version as "released" in JIRA


9. In case of major releases, publish news to:

   carrot2-news@lists.sourceforge.net
   carrot2-developers@lists.sourceforge.net
   Lucene/Nutch lists?
   KDNuggets

   Also:

   a. add brief release notes (website/src/release-VERSION-notes.xml)
      with a summary of the major and minor changes
   b. add a one-sentence news info on the main page (website/src/index.xml)
      with a link to the release-VERSION-notes file



Quality Assurance [before a release]
-----------------

- Update license files (update the year too, if needed).

    When updating the license, check the following locations:
    
    - ${svn}/carrot2.LICENSE, 
    - ${svn}/etc/codeconvention/*.txt
    
    then run 'ant license' to update the sources (review output).
    
    - http://project.carrot2.org/license.html
    - http://project.carrot2.org/carrot2.LICENSE

- Make sure the local checkout is in sync with the server:

	svn stat -u                 (nothing should be printed)

- Go to carrot root checkout and issue the following:

	ant -q cleanall clean

	ant -q test                 (all tests must pass)
	
	ant -q build                (remote and local applications must build)

	ant javadoc                 (no fatal errors)


- Create a distribution for final testing, replacing "VERSION" with real release number.

	ant -q -Drelease.number=VERSION dist


- Try the local application


- Deploy remote applications on a clean Tomcat server, modify server.xml according
to instructions in the readme.txt file. See if it works.


- Again check if there are no locally modified sources:

	svn stat -u                 (nothing should be printed)
