
<project name="Carrot2 Tests deploy script." default="help" basedir=".">

    <property name="checkout.dir" location="tmp/checkouts" />
    <property name="cvs.pass" location="${user.home}/.cvspass" />
    <property name="module.name" value="tests" />
    <property name="cvs.root" value=":pserver:anonymous@cvs.sourceforge.net:/cvsroot/carrot2" />

    <property name="runtime.env" location="../runtime" />
    <property name="runtime.logs" location="${runtime.env}/context-logs/test-report" />
    <property name="distribution.dir" location="${runtime.logs}" />

    <property name="test.url" value="http://carrot.cs.put.poznan.pl:2001/carrot2-web-controller" />

    <!-- 
      ## Prepare checkout directory and cvs environment.
      -->

    <target name="vars">
        <mkdir dir="${checkout.dir}" />
    </target>
      
    <target name="prepare" depends="vars">
    </target>
    
    <target name="clean">
        <delete failonerror="false" includeemptydirs="true" quiet="true">
            <fileset dir="${distribution.dir}" excludes="index.html" />
        </delete>
    </target>

    <target name="cvsupdate" depends="vars,prepare">
        <cvspass cvsroot="${cvs.root}" password="" passfile="${cvs.pass}"/>

        <ant antfile="cvsoperations.xml" target="cvs.checkout_or_update.module" inheritall="false">
            <property name="checkout.dir" location="${checkout.dir}" />
            <property name="cvs.pass"     location="${cvs.pass}" />
            <property name="module.name" value="${module.name}" />
            <property name="cvs.root" value="${cvs.root}" />
        </ant>
    </target>

    <!-- 
      ## Build tests
      -->
    <target name="build" depends="clean,prepare">
        <ant antfile="${checkout.dir}/${module.name}/build.xml" 
             dir="${checkout.dir}/${module.name}" inheritall="false" 
             target="test">
            <property name="distribution.dir" location="${distribution.dir}" />
            <property name="test.url" value="${test.url}" />
        </ant>
    </target>

    
  <!-- ##################################### -->
  <!-- ### {{{ HELP ON THIS FILE         ### -->
  <!-- ##################################### -->
    <target name="help" description="Displays help on available targets.">
    <echo>
    This ANT script is used to deploy Carrot2 demo site.
    It is for internal use only and contains no public targets.
    </echo>
    </target>
  <!-- }}} -->

</project>

