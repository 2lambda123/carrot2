
<project name="Carrot2 ANT Extensions bootstrap build file."
		 default="build">

    <property name="project.dir"      location="${basedir}" />
    <property name="carrot2.cvs.dir"  location="../.." />
    <property name="dist.name"        value="carrot2-ant-extensions" />

    <property name="type"       	  value="jartype" />
    <property name="tests.available"  value="true"    />
    <import file="${carrot2.cvs.dir}/components/common-targets.inc" />

    <!-- bootstrap build -->
    
    <target name="bootstrap">
		<echo>
Bootstrapping ANT extension tasks.
		</echo>

        <mkdir dir="tmp/build/bootstrap" />
        <javac destdir     = "tmp/build/bootstrap"
               debug       = "true"
               optimize    = "false"
               deprecation = "on"
               includeantruntime = "true"
               includejavaruntime = "false"
        >
            <src path="src" />
        </javac>
        <copy todir="tmp/build/bootstrap/res">
            <fileset dir="${carrot2.cvs.dir}/etc">
                <include name="catalog.xml" />
                <include name="component-dependency.dtd" />
            </fileset>
        </copy>

        <mkdir dir="tmp/dist" />
        <jar compress="true" jarfile="tmp/${dist.name}.jar">
            <fileset dir="tmp/build/bootstrap" />
            <manifest>
                <attribute name="Built-By"   value="${user.name}"/>
            </manifest>
        </jar>
    </target>

    <!-- common template tasks. -->

    <target name="build">
        <property name="include.ant.runtime" value="true" />
        <ant target="build.jartype" antfile="../master.xml" inheritall="true" inheritrefs="true" />
    </target>

    <target name="test">
        <property name="profile" value="test" />
        <property name="include.ant.runtime" value="true" />
        <ant target="build.testtype" antfile="../master.xml" inheritall="true" inheritrefs="true" />
    </target>

</project>
