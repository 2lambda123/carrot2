<?xml version="1.0" encoding="UTF-8"?>

<process
    xmlns="http://www.dawidweiss.com/projects/carrot/processDescriptor"
    id="carrot2.process.scripted.ahc-google-cs-only-idf"
    description="Google (*.cs.put.poznan.pl), Stemmer, TfIdf Terms weighing, AHC, Dynamic Tree"
>
    <processing-script language="beanshell"><![CDATA[
    
    controller.setUseCachedInput(true);
    controller.setDoCacheInput(true);

    InputStream is;
    
    is = controller.invokeInputComponent( "carrot2.input.snippet-reader.google.cs-only", query );

    is = controller.invokeFilterComponent( "carrot2.filter.stemming", is );

    Map         termsOptions = new HashMap();
    termsOptions.put("termsWeighing", "com.mwroblewski.carrot.filter.termsfilter.weighing.TfLinearIdfWeighing");
    termsOptions.put("maxPhrasesLength", "5");
    termsOptions.put("minPhrasesStrength", "1.0");
    termsOptions.put("strongTermsWeight", "1.0");
    termsOptions.put("removeQuery", "true");
    termsOptions.put("removeSingleTerms", "true");

    is = controller.invokeFilterComponent( "carrot2.filter.ahc.termsfilter", is, termsOptions );

    Map         ahcOptions = new HashMap();
    ahcOptions.put("similarityMeasure", "com.mwroblewski.carrot.filter.ahcfilter.ahc.similarity.CosineSimilarity");
    ahcOptions.put("linkageMethod", "com.mwroblewski.carrot.filter.ahcfilter.ahc.linkage.CompleteLinkage");
    ahcOptions.put("stopCondition", "");
    ahcOptions.put("groupsCreatingThreshold", "0.0");
    ahcOptions.put("removeGroupsSimilarWithParents", "false");
    ahcOptions.put("maxDescriptionLength", "3");
    ahcOptions.put("minDescriptionOccurrence", "0.6");
    ahcOptions.put("showDebugGroupDescription", "false");
    ahcOptions.put("groupOverlapThreshold", "0.5");
    ahcOptions.put("groupCoverageThreshold", "0.2");
    ahcOptions.put("removeGroupsWithoutDescription", "true");
    ahcOptions.put("mergeGroupsWithSimilarDescriptions", "true");
    ahcOptions.put("removeTopGroup", "true");

    is = controller.invokeFilterComponent( "carrot2.filter.ahc.ahc", is , ahcOptions);

    Map dtreeOptions = new HashMap();
    dtreeOptions.put("dtree.css", "compact");
    dtreeOptions.put("param.output.terminal.nodes", "false" );
    dtreeOptions.put("param.max.open.level", "0");
    dtreeOptions.put("param.max.subgroup.snippets.included", "3" );
    dtreeOptions.put("param.no.terminal.groups.expansion", "true" );
    dtreeOptions.put("param.snippets.sorting.type", "ORDER_DOCUMENTS_ORDER");

    is = controller.invokeOutputComponent( "carrot2.output.xslt-renderer.dynamic-tree", is, dtreeOptions );
    
    controller.sendResponse( is ); 
    
    ]]>
    </processing-script>
</process>

